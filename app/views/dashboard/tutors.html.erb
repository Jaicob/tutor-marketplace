<header>
  <div class="row">
    <div class="large-12 columns">
      <h1>Tutors</h1>
    </div>
  </div>
</header>

<%= console %>

<section>
  <div class="row">
    <div class="large-6 columns">
      <h4>Active Status</h4>
        <p class="button tiny success">Active</p><br>
        <p class="button tiny secondary">Inactive</p>
    </div>
    <div class="large-6 columns">
      <h4>Application Status</h4>
        <p class="button tiny info">Applied</p><br>
        <p class="button tiny alert">Awaiting Approval</p><br>
        <p class="button tiny default">Approved</p><br>
    </div>
  </div>
</section>

<%= link_to 'Download CSV', tutors_path(format: :csv) %>

<main>
  <div class="row full-width">
    <div class="large-12 columns">
      <table>
        <thead>
          <tr>
            <th width="150">Active Status</th>
            <th width="250">Name</th>
            <th width="300">Email</th>
            <th width="250">School</th>
            <th width="150">Application Status</th>
            <th width="150">Delete</th>
          </tr>
        </thead>
        <tbody>
          <% @tutors.each do |tutor| %>
          <tr>
            <td>
              <% if tutor.active_status == 'Active' %>
                <span class="button tiny success expand"><a href="#" data-reveal-id="confirmTutorDeactivationModal-<%= tutor.id %>" class="white-link-text"><%= tutor.active_status %></a></span></td>
              <% else %>
                <span class="button tiny secondary expand"><a href="#" data-reveal-id="confirmTutorActivationModal-<%= tutor.id %>" class="black-link-text"><%= tutor.active_status %></a></span></td>
              <% end %>
            </td>
            <td><%= tutor.user.full_name %></td>
            <td><%= tutor.user.email %></td>
            <td><% tutor.schools.each do |school| %>
                  <%= school %><br>
                <% end %>
            </td>
            <td><span class="<%= tutor.application_status %>">
                  <a href="#" data-reveal-id="tutorDocumentsModal-<%= tutor.id %>" class="black-link-text"><%= tutor.application_status %></a>
                </span>
            </td>
            <td><span class="button tiny secondary expand"><a href="#" data-reveal-id="confirmDestroyTutorModal-<%= tutor.id %>" class="black-link-text">Delete</a></span></td>
          </tr>

            <!-- Modal to confirm Tutor activation -->
            
            <div id="confirmTutorActivationModal-<%= tutor.id %>" class="reveal-modal small" data-reveal aria-labelledby="secondModalTitle" aria-hidden="true" role="dialog">

              <h4 id="secondModalTitle" class="text-center">Are you sure you want to activate this tutor?</h4>

              <div class="row">
                <div class="small-8 small-centered columns">
                  <div class="text-center">
                    <h2><%= tutor.user.full_name %></h2>
                    
                    <%= form_for tutor do |f| %>
                      <%= f.hidden_field :active_status, value: 'Active' %>
                      <%= f.submit 'Activate' %>
                    <% end %>

                  </div>
                </div>
              </div>
            </div>

            <!-- Modal to confirm Tutor de-activation -->

            <div id="confirmTutorDeactivationModal-<%= tutor.id %>" class="reveal-modal small" data-reveal aria-labelledby="secondModalTitle" aria-hidden="true" role="dialog">

              <h4 id="secondModalTitle" class="text-center">Are you sure you want to de-activate this tutor?</h4>

              <div class="row">
                <div class="small-8 small-centered columns">
                  <div class="text-center">
                    <h2><%= tutor.user.full_name %></h2>

                    <%= form_for tutor do |tutor| %>
                      <%= tutor.hidden_field :active_status, value: 'Inactive' %>
                      <%= tutor.submit 'Deactivate' %>
                    <% end %>

                  </div>
                </div>
              </div>
            </div>

            <!-- Modal to view/download Tutor documents -->

            <div id="tutorDocumentsModal-<%= tutor.id %>" class="reveal-modal small" data-reveal aria-labelledby="secondModalTitle" aria-hidden="true" role="dialog">

              <h4 id="secondModalTitle" class="text-center">Tutor Documents</h4>

              <div class="row">
                <div class="small-8 small-centered columns">
                  <div class="text-center">
                    <h2><%= tutor.user.full_name %></h2>

                    <%= image_tag(tutor.profile_pic_url(:thumb)) %>

                    <%= link_to "Download Transcript", tutor.transcript.url %>

                  </div>
                </div>
              </div>
            </div>


            <!-- Modal to confirm Tutor deletion -->

            <div id="confirmDestroyTutorModal-<%= tutor.id %>" class="reveal-modal small" data-reveal aria-labelledby="secondModalTitle" aria-hidden="true" role="dialog">
              <h4 id="secondModalTitle" class="text-center">Are you sure you want to permanently destroy this tutor account?</h4>
              <h6>You can deactivate the tutor to temporarily disable the account.</h6>

              <div class="row">
                <div class="small-8 small-centered columns">
                  <div class="text-center">
                    <h2><%= tutor.user.full_name %></h2>

                    <%= form_for tutor, method: 'delete' do |tutor| %>
                      <%= tutor.submit 'Delete' %>
                    <% end %>

                  </div>
                </div>
              </div>
            </div>

          <% end %>

        </tbody>
      </table>
    </div>
  </div>
</main>