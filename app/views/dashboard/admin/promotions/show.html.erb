<div class="row">
  <div class="small-12 medium-8 columns">
    <h3>Promotion #<%= @promotion.id %></h3>
    <%= link_to 'Edit', edit_admin_promotion_path(@promotion), class: 'custom-button gray' %>
  </div>
  <div class="small-12 medium-4 columns">
    <%= link_to 'All Promotions', admin_promotions_path, class: 'custom-button full-width blue' %>
  </div>
</div>

<!-- Promotion Details -->

<div class="row">
  <div class="small-12 columns">
    <h4>Promotion Details</h4>
    <table>
      <thead>
        <tr>
          <th>ID</th>
          <th>Code</th>
          <th>Discount Percentage</th>
          <th>Start Date</th>
          <th>End Date</th>
          <th>Redemption Limit</th>
          <th>Redemption Count</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td><%= link_to @promotion.id, admin_promotion_path(@promotion), class: 'id-link-for-admin' %></td>
          <td><%= @promotion.code %></td>
          <td><%= @promotion.amount %></td>
          <td><%= @promotion.valid_from %></td>
          <td><%= @promotion.valid_until %></td>
          <td><%= @promotion.redemption_limit %></td>
          <td><%= @promotion.redemption_count %></td>
        </tr>
      </tbody>
      <thead>
        <tr>
          <th>Redeemer</th>
          <th>Single Appt/Booking</th>
          <th>Single Redemption/Student</th>
          <th>Student ID</th>
          <th>Course ID</th>
          <th>Tutor ID</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td><%= @promotion.redeemer.humanize if @promotion.redeemer %></td>
          <td><%= @promotion.single_appt == 'true' ? 'True' : 'False' %></td>
          <td><%= @promotion.repeat_use == 'repeat' ? 'True' : 'False' %></td>
          <td><%= @promotion.student_id if @promotion.student_id %></td>
          <td><%= @promotion.course_id if @promotion.course_id %></td>
          <td><%= @promotion.tutor_id if @promotion.tutor_id %></td>
          <td><%= @promotion.description %></td>
        </tr>
      </tbody>
    </table>
  </div>
</div>

<!-- Promotion Redemptions -->

<div class="row">
  <div class="small-12 columns">
    <h4>Redemptions</h4>
    <% if @promotion.charges.any? %>
      <table>
        <thead>
          <tr>
            <th>#</th>
            <th>Charge ID</th>
            <th>Appt. IDs</th>
            <th>Stripe Charge ID</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <% @promotion.charges.each do |charge| %>
              <td>#</td>
              <td><%= charge.id %></td>
              <td><%= charge.appointments.map{|appt| appt.id} %></td>
              <td><%= charge.stripe_charge_id %></td>
            <% end %>
          </tr>
        </tbody>
      </table>
    <% else %>
      <p>No redemptions</p>
    <% end %>
  </div>
</div>