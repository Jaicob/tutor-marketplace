/*! Chained 1.0.0 - MIT license - Copyright 2010-2014 Mika Tuupola */

!function(t){"use strict";t.fn.remoteChained=function(e){var n=t.extend({},t.fn.remoteChained.defaults,e);return n.loading&&(n.clear=!0),this.each(function(){function e(e){var r=t(":selected",a).val();t("option",a).remove();for(var i=n.data_formatter(e),o=0;o!==i.length;o++){var l=i[o][0],s=i[o][1];if("selected"!==l){var c=t("<option />").val(l).append(s);t(a).append(c)}else r=s}t(a).children().each(function(){t(this).val()===r+""&&t(this).attr("selected","selected")}),1===t("option",a).size()&&""===t(a).val()?t(a).prop("disabled",!0):t(a).prop("disabled",!1)}var a=this,r=!1;t(n.parents).each(function(){t(this).bind("change",function(){var i={};t(n.parents).each(function(){var e=t(this).attr(n.attribute),r=(t(this).is("select")?t(":selected",this):t(this)).val();i[e]=r,n.depends&&t(n.depends).each(function(){if(a!==this){var e=t(this).attr(n.attribute),r=t(this).val();i[e]=r}})}),r&&t.isFunction(r.abort)&&(r.abort(),r=!1),n.clear&&(n.loading?e.call(a,n.loading):t("option",a).remove(),t(a).trigger("change"));var o;o="function"==typeof n.url?n.url():n.url,r=t.getJSON(o,i,function(n){e.call(a,n),t(a).trigger("change")})}),n.bootstrap&&(e.call(a,n.bootstrap),n.bootstrap=null)})})},t.fn.remoteChainedTo=t.fn.remoteChained,t.fn.remoteChained.defaults={attribute:"name",depends:null,bootstrap:null,loading:null,clear:!1,data_formatter:function(e){if("string"==typeof e)return[["",settings.loading]];var n=[];if(t.isArray(e))n=t.isArray(e[0])?e:t.map(e,function(e){return t.map(e,function(t,e){return[[e,t]]})});else for(var a in e)e.hasOwnProperty(a)&&n.push([a,e[a]]);return n}}}(window.jQuery||window.Zepto,window,document);
