<section class="dashboard-earnings-report">
  <div class="wrapper">
    <h3>Earnings Report</h3>
    <p>Graph Source: <a href="http://codepen.io/WhatIsHeDoing/pen/uylGL" target="_new">http://codepen.io/WhatIsHeDoing/pen/uylGL</a></p>
    <div class="earnings_chart"></div>
  </div>
</section>
<script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/d3/3.4.6/d3.min.js"></script>
<script>
  var data = [
    { "name": "January", "earnings" : 360.43 },
    { "name": "February", "earnings" : 325.71 },
    { "name": "March", "earnings" : 183.75 },
    { "name": "April", "earnings" : 517.66 },
    { "name": "May", "earnings" : 61.72 },
    { "name": "June", "earnings" : 130.27 }
  ];

  var chartHeight = 500;
  var chartWidth = 1000;

  var margin = {
    bottom: 30,
    left: 50,
    right: 0,
    top: 20,
  };

  var height = chartHeight - margin.top - margin.bottom;
  var width = chartWidth - margin.left - margin.right;

  var x = d3
    .scale.ordinal()
    .rangeRoundBands([0, width], .1);

  var y = d3
    .scale.linear()
    .range([height, 0]);

  var xAxis = d3
    .svg.axis()
    .scale(x)
    .orient("bottom");

  var yAxis = d3
    .svg.axis()
    .scale(y)
    .orient("left")
    .ticks(10, "B");

  var svg = d3
    .select(".earnings_chart")
    .append("svg")
    .attr({
      "height": chartHeight,
      "preserveAspectRatio": "xMidYMid",
      "viewBox": [0, 0, chartWidth, chartHeight].join(" "),
      "width": chartWidth
    })
    .append("g")
    .attr("transform", "translate(" + margin.left + "," + margin.top + ")");

  function getLabel(d) {
    return d.name;
  }

  function getValue(d) {
    return d.earnings;
  }

  x.domain(data.map(getLabel));
  y.domain([0, d3.max(data, getValue)]);

  svg
    .append("g")
    .attr({
      "class": "x axis",
      "transform": "translate(0," + height + ")"
    })
    .call(xAxis);

  svg
    .append("g")
    .attr("class", "y axis")
    .call(yAxis)
    .append("text")
    .attr({
      "dy": ".7em",
      "transform": "rotate(-90)",
      "y": 6
    })
    .style("text-anchor", "end")
    .text("Earnings ($)");

  svg
    .selectAll(".bar")
    .data(data)
    .enter().append("rect")
    .attr({
      "class": "bar",
      "height": function(d) { return height - y(getValue(d)); },
      "width": x.rangeBand(),
      "x": function(d) { return x(getLabel(d)); },
      "y": function(d) { return y(getValue(d)); }
    });

  var aspect = chartWidth / chartHeight;
  var chart = $(".earnings_chart svg");
  var container = chart.parent();

  function resize() {
    var targetWidth = container.width();

    chart.attr({
      "height": targetWidth / aspect,
      "width": targetWidth
    });
  }

  resize();
  $(window).resize(resize);
</script>